f1
dev.off()
averageMutSpec = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,5:16]; summary(averageMutSpec)
averageMutSpec = averageMutSpec[!is.na(averageMutSpec$C_A.SubstRate.heavy) & !is.na(averageMutSpec$C_G.SubstRate.heavy) & !is.na(averageMutSpec$C_T.SubstRate.heavy),]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
View(mutSpecCytB)
averageMutSpec = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec)
averageMutSpec = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
averageMutSpec = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
averageMutSpec = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]; summary(averageMutSpec)
averageMutSpec = averageMutSpec[!is.na(averageMutSpec$C_A.SubstRate.heavy) & !is.na(averageMutSpec$C_G.SubstRate.heavy) & !is.na(averageMutSpec$C_T.SubstRate.heavy),]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
averageMutSpec = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec = averageMutSpec[!is.na(averageMutSpec$C_A.SubstRate.heavy) & !is.na(averageMutSpec$C_G.SubstRate.heavy) & !is.na(averageMutSpec$C_T.SubstRate.heavy),]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
averageMutSpec = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]; summary(averageMutSpec)
averageMutSpec = averageMutSpec[!is.na(averageMutSpec$C_A.SubstRate.heavy) & !is.na(averageMutSpec$C_G.SubstRate.heavy) & !is.na(averageMutSpec$C_T.SubstRate.heavy),]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
averageMutSpec = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec = averageMutSpec[!is.na(averageMutSpec$C_A.SubstRate.heavy) & !is.na(averageMutSpec$C_G.SubstRate.heavy) & !is.na(averageMutSpec$C_T.SubstRate.heavy),]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
averageMutSpec = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
View(averageMutSpec)
f1
averageMutSpec = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec = averageMutSpec[!is.na(averageMutSpec$C_A.SubstRate.heavy) & !is.na(averageMutSpec$C_G.SubstRate.heavy) & !is.na(averageMutSpec$C_T.SubstRate.heavy),]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
averageMutSpec = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),][,5:16]
names(mutSpec)
mutSpecAllMeanBySums = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMeanBySums = mutSpecAllMeanBySums %>% summarise(T.heavy=sum(T.heavy), A.heavy=sum(A.heavy), C.heavy=sum(C.heavy), G.heavy=sum(G.heavy), A_G.heavy=sum(A_G.heavy), A_T.heavy=sum(A_T.heavy), A_C.heavy=sum(A_C.heavy), T_G.heavy=sum(T_G.heavy), T_A.heavy=sum(T_A.heavy), T_C.heavy=sum(T_C.heavy), G_T.heavy=sum(G_T.heavy), G_C.heavy=sum(G_C.heavy), G_A.heavy= sum(G_A.heavy), C_G.heavy=sum(C_G.heavy), C_T.heavy=sum(C_T.heavy), C_A.heavy=sum(C_A.heavy)) %>% ungroup()
mutSpecAllMeanBySums$A_G.SubstRate.heavy=mutSpecAllMeanBySums$A_G.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$A_T.SubstRate.heavy=mutSpecAllMeanBySums$A_T.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$A_C.SubstRate.heavy=mutSpecAllMeanBySums$A_C.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$T_G.SubstRate.heavy=mutSpecAllMeanBySums$T_G.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$T_A.SubstRate.heavy=mutSpecAllMeanBySums$T_A.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$T_C.SubstRate.heavy=mutSpecAllMeanBySums$T_C.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$G_T.SubstRate.heavy=mutSpecAllMeanBySums$G_T.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$G_C.SubstRate.heavy=mutSpecAllMeanBySums$G_C.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$G_A.SubstRate.heavy=mutSpecAllMeanBySums$G_A.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$C_G.SubstRate.heavy=mutSpecAllMeanBySums$C_G.heavy/mutSpecAllMeanBySums$C.heavy
mutSpecAllMeanBySums$C_T.SubstRate.heavy=mutSpecAllMeanBySums$C_T.heavy/mutSpecAllMeanBySums$C.heavy
mutSpecAllMeanBySums$C_A.SubstRate.heavy=mutSpecAllMeanBySums$C_A.heavy/mutSpecAllMeanBySums$C.heavy
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),][,5:16]
averageMutSpec = averageMutSpec[!is.na(averageMutSpec$C_A.SubstRate.heavy) & !is.na(averageMutSpec$C_G.SubstRate.heavy) & !is.na(averageMutSpec$C_T.SubstRate.heavy),]; summary(averageMutSpec)
names(mutSpec)
mutSpecAllMeanBySums = mutSpec %>% group_by(Species); mutSpecAllMeanBySums = mutSpecAllMeanBySums %>% summarise(T.heavy=sum(T.heavy), A.heavy=sum(A.heavy), C.heavy=sum(C.heavy), G.heavy=sum(G.heavy), A_G.heavy=sum(A_G.heavy), A_T.heavy=sum(A_T.heavy), A_C.heavy=sum(A_C.heavy), T_G.heavy=sum(T_G.heavy), T_A.heavy=sum(T_A.heavy), T_C.heavy=sum(T_C.heavy), G_T.heavy=sum(G_T.heavy), G_C.heavy=sum(G_C.heavy), G_A.heavy= sum(G_A.heavy), C_G.heavy=sum(C_G.heavy), C_T.heavy=sum(C_T.heavy), C_A.heavy=sum(C_A.heavy)) %>% ungroup()
mutSpecAllMeanBySums$A_G.SubstRate.heavy=mutSpecAllMeanBySums$A_G.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$A_T.SubstRate.heavy=mutSpecAllMeanBySums$A_T.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$A_C.SubstRate.heavy=mutSpecAllMeanBySums$A_C.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$T_G.SubstRate.heavy=mutSpecAllMeanBySums$T_G.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$T_A.SubstRate.heavy=mutSpecAllMeanBySums$T_A.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$T_C.SubstRate.heavy=mutSpecAllMeanBySums$T_C.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$G_T.SubstRate.heavy=mutSpecAllMeanBySums$G_T.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$G_C.SubstRate.heavy=mutSpecAllMeanBySums$G_C.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$G_A.SubstRate.heavy=mutSpecAllMeanBySums$G_A.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$C_G.SubstRate.heavy=mutSpecAllMeanBySums$C_G.heavy/mutSpecAllMeanBySums$C.heavy
mutSpecAllMeanBySums$C_T.SubstRate.heavy=mutSpecAllMeanBySums$C_T.heavy/mutSpecAllMeanBySums$C.heavy
mutSpecAllMeanBySums$C_A.SubstRate.heavy=mutSpecAllMeanBySums$C_A.heavy/mutSpecAllMeanBySums$C.heavy
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec = mutSpecCytB[mutSpecCytB$Class == "Actinopterygii" & mutSpecCytB$Class == "Chondrichthyes",),][,26:37]; summary(averageMutSpec)
averageMutSpec = mutSpecCytB[mutSpecCytB$Class == "Actinopterygii" & mutSpecCytB$Class == "Chondrichthyes",][,26:37]; summary(averageMutSpec)
View(averageMutSpec)
View(mutSpecCytB)
averageMutSpec = mutSpecCytB[mutSpecCytB$Class == "Actinopterygii" & mutSpecCytB$Class == "Chondrichthyes",]
averageMutSpec
View(mutSpecAllMeanBySums)
names(mutSpec)
mutSpecAllMeanBySums = mutSpec %>% group_by(Species, temperature); mutSpecAllMeanBySums = mutSpecAllMeanBySums %>% summarise(T.heavy=sum(T.heavy), A.heavy=sum(A.heavy), C.heavy=sum(C.heavy), G.heavy=sum(G.heavy), A_G.heavy=sum(A_G.heavy), A_T.heavy=sum(A_T.heavy), A_C.heavy=sum(A_C.heavy), T_G.heavy=sum(T_G.heavy), T_A.heavy=sum(T_A.heavy), T_C.heavy=sum(T_C.heavy), G_T.heavy=sum(G_T.heavy), G_C.heavy=sum(G_C.heavy), G_A.heavy= sum(G_A.heavy), C_G.heavy=sum(C_G.heavy), C_T.heavy=sum(C_T.heavy), C_A.heavy=sum(C_A.heavy)) %>% ungroup()
mutSpecAllMeanBySums$A_G.SubstRate.heavy=mutSpecAllMeanBySums$A_G.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$A_T.SubstRate.heavy=mutSpecAllMeanBySums$A_T.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$A_C.SubstRate.heavy=mutSpecAllMeanBySums$A_C.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$T_G.SubstRate.heavy=mutSpecAllMeanBySums$T_G.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$T_A.SubstRate.heavy=mutSpecAllMeanBySums$T_A.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$T_C.SubstRate.heavy=mutSpecAllMeanBySums$T_C.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$G_T.SubstRate.heavy=mutSpecAllMeanBySums$G_T.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$G_C.SubstRate.heavy=mutSpecAllMeanBySums$G_C.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$G_A.SubstRate.heavy=mutSpecAllMeanBySums$G_A.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$C_G.SubstRate.heavy=mutSpecAllMeanBySums$C_G.heavy/mutSpecAllMeanBySums$C.heavy
mutSpecAllMeanBySums$C_T.SubstRate.heavy=mutSpecAllMeanBySums$C_T.heavy/mutSpecAllMeanBySums$C.heavy
mutSpecAllMeanBySums$C_A.SubstRate.heavy=mutSpecAllMeanBySums$C_A.heavy/mutSpecAllMeanBySums$C.heavy
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),][,5:16]
averageMutSpec = averageMutSpec[!is.na(averageMutSpec$C_A.SubstRate.heavy) & !is.na(averageMutSpec$C_G.SubstRate.heavy) & !is.na(averageMutSpec$C_T.SubstRate.heavy),]; summary(averageMutSpec)
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),][,5:16]
View(averageMutSpec)
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),][,5:16]
View(averageMutSpec)
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),]
View(averageMutSpec)
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),][,26:30]
View(averageMutSpec)
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),][,23:30]
View(averageMutSpec)
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),][,20:30]
View(averageMutSpec)
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),][,19:30]
View(averageMutSpec)
averageMutSpec = mutSpecAllMeanBySums[!is.na(mutSpecAllMeanBySums$temperature),][,19:30]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec = mutSpecAllMeanBySums[,19:30]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec = mutSpecAllMeanBySums[,19:30]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec = mutSpecAllMeanBySums[,19:30]; summary(averageMutSpec)
averageMutSpec = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec$Subs = row.names(averageMutSpec); names(averageMutSpec) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
View(averageMutSpec)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec1)
averageMutSpec1 = as.data.frame(apply(averageMutSpec, 2, mean)); averageMutSpec1$Subs = row.names(averageMutSpec1); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec1)
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = row.names(averageMutSpec1); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = row.names(averageMutSpec2); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
averageMutSpec3 = mutSpecAllMeanBySums[,19:30]; summary(averageMutSpec3)
averageMutSpec3 = as.data.frame(apply(averageMutSpec3, 2, mean)); averageMutSpec3$Subs = row.names(averageMutSpec3); names(averageMutSpec3) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec3, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
View(averageMutSpec)
View(averageMutSpec1)
View(averageMutSpec2)
View(averageMutSpec)
View(averageMutSpec1)
View(averageMutSpec1)
View(averageMutSpec)
View(averageMutSpec2)
View(averageMutSpec)
View(averageMutSpec1)
View(averageMutSpec2)
cor.test(mutSpecCytB$A_G.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_A.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_C.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_T.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
names(mutSpec)
mutSpecAllMeanBySums = mutSpec %>% group_by(Species, temperature); mutSpecAllMeanBySums = mutSpecAllMeanBySums %>% summarise(T.heavy=sum(T.heavy), A.heavy=sum(A.heavy), C.heavy=sum(C.heavy), G.heavy=sum(G.heavy), A_G.heavy=sum(A_G.heavy), A_T.heavy=sum(A_T.heavy), A_C.heavy=sum(A_C.heavy), T_G.heavy=sum(T_G.heavy), T_A.heavy=sum(T_A.heavy), T_C.heavy=sum(T_C.heavy), G_T.heavy=sum(G_T.heavy), G_C.heavy=sum(G_C.heavy), G_A.heavy= sum(G_A.heavy), C_G.heavy=sum(C_G.heavy), C_T.heavy=sum(C_T.heavy), C_A.heavy=sum(C_A.heavy)) %>% ungroup()
mutSpecAllMeanBySums$A_G.SubstRate.heavy=mutSpecAllMeanBySums$A_G.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$A_T.SubstRate.heavy=mutSpecAllMeanBySums$A_T.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$A_C.SubstRate.heavy=mutSpecAllMeanBySums$A_C.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$T_G.SubstRate.heavy=mutSpecAllMeanBySums$T_G.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$T_A.SubstRate.heavy=mutSpecAllMeanBySums$T_A.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$T_C.SubstRate.heavy=mutSpecAllMeanBySums$T_C.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$G_T.SubstRate.heavy=mutSpecAllMeanBySums$G_T.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$G_C.SubstRate.heavy=mutSpecAllMeanBySums$G_C.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$G_A.SubstRate.heavy=mutSpecAllMeanBySums$G_A.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$C_G.SubstRate.heavy=mutSpecAllMeanBySums$C_G.heavy/mutSpecAllMeanBySums$C.heavy
mutSpecAllMeanBySums$C_T.SubstRate.heavy=mutSpecAllMeanBySums$C_T.heavy/mutSpecAllMeanBySums$C.heavy
mutSpecAllMeanBySums$C_A.SubstRate.heavy=mutSpecAllMeanBySums$C_A.heavy/mutSpecAllMeanBySums$C.heavy
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
mutSpecAllMeanBySums = mutSpec %>% group_by(Species, temperature); mutSpecAllMeanBySums = mutSpecAllMeanBySums %>% summarise(T.heavy=sum(T.heavy), A.heavy=sum(A.heavy), C.heavy=sum(C.heavy), G.heavy=sum(G.heavy), A_G.heavy=sum(A_G.heavy), A_T.heavy=sum(A_T.heavy), A_C.heavy=sum(A_C.heavy), T_G.heavy=sum(T_G.heavy), T_A.heavy=sum(T_A.heavy), T_C.heavy=sum(T_C.heavy), G_T.heavy=sum(G_T.heavy), G_C.heavy=sum(G_C.heavy), G_A.heavy= sum(G_A.heavy), C_G.heavy=sum(C_G.heavy), C_T.heavy=sum(C_T.heavy), C_A.heavy=sum(C_A.heavy)) %>% ungroup()
mutSpecAllMeanBySums$A_G.SubstRate.heavy=mutSpecAllMeanBySums$A_G.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$A_T.SubstRate.heavy=mutSpecAllMeanBySums$A_T.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$A_C.SubstRate.heavy=mutSpecAllMeanBySums$A_C.heavy/mutSpecAllMeanBySums$A.heavy
mutSpecAllMeanBySums$T_G.SubstRate.heavy=mutSpecAllMeanBySums$T_G.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$T_A.SubstRate.heavy=mutSpecAllMeanBySums$T_A.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$T_C.SubstRate.heavy=mutSpecAllMeanBySums$T_C.heavy/mutSpecAllMeanBySums$T.heavy
mutSpecAllMeanBySums$G_T.SubstRate.heavy=mutSpecAllMeanBySums$G_T.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$G_C.SubstRate.heavy=mutSpecAllMeanBySums$G_C.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$G_A.SubstRate.heavy=mutSpecAllMeanBySums$G_A.heavy/mutSpecAllMeanBySums$G.heavy
mutSpecAllMeanBySums$C_G.SubstRate.heavy=mutSpecAllMeanBySums$C_G.heavy/mutSpecAllMeanBySums$C.heavy
mutSpecAllMeanBySums$C_T.SubstRate.heavy=mutSpecAllMeanBySums$C_T.heavy/mutSpecAllMeanBySums$C.heavy
mutSpecAllMeanBySums$C_A.SubstRate.heavy=mutSpecAllMeanBySums$C_A.heavy/mutSpecAllMeanBySums$C.heavy
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec1)
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = row.names(averageMutSpec1); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = row.names(averageMutSpec2); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = row.names(averageMutSpec2); names(averageMutSpec2) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = row.names(averageMutSpec2); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = row.names(averageMutSpec2); names(averageMutSpec2) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = row.names(averageMutSpec2); names(averageMutSpec2) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
#palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
cor.test(mutSpecAllMean$A_G.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_A.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_C.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_T.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
View(averageMutSpec2)
View(averageMutSpec1)
View(averageMutSpec)
View(averageMutSpec1)
View(averageMutSpec2)
cor.test(mutSpecAllMeanBySums$A_G.SubstRate.heavy,mutSpecAllMeanBySums$temperature, method = 'spearman')
cor.test(mutSpecAllMeanBySums$G_A.SubstRate.heavy,mutSpecAllMeanBySums$temperature, method = 'spearman')
cor.test(mutSpecAllMeanBySums$T_C.SubstRate.heavy,mutSpecAllMeanBySums$temperature, method = 'spearman')
cor.test(mutSpecAllMeanBySums$C_T.SubstRate.heavy,mutSpecAllMeanBySums$temperature, method = 'spearman')
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = row.names(averageMutSpec2); names(averageMutSpec2) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#036a5b", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#9c3d37", "#055088", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#73514f", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
View(averageMutSpec2)
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = row.names(averageMutSpec2); names(averageMutSpec2) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
View(averageMutSpec2)
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = row.names(averageMutSpec2); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
mutSpecAllMean$AGdivTC=mutSpecAllMean$A_G.SubstRate.heavy/mutSpecAllMean$T_C.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$AGdivTC == "Inf" | mutSpecAllMean$AGdivTC == "NaN",]$AGdivTC = NA
cor.test(mutSpecAllMean$AGdivTC,mutSpecAllMean$temperature, method = 'spearman')
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "A_G.SubstRate.heavy",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 AH>GH") + stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
f1b1 = ggscatter(mutSpecAllMean, x = "temperature", y = "C_T.SubstRate.heavy",
color = "#055088", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 CH>TH")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1b1
f1b2 = ggscatter(mutSpecAllMean, x = "temperature", y = "G_A.SubstRate.heavy",
color = "#9c3d37", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 GH>AH")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1b2
f1c = ggscatter(mutSpecAllMean, x = "temperature", y = "AGdivTC",
color = "#814194", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 A_GdivT_C")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1c
cor.test(mutSpecAllMean$A_G.SubstRate.heavy,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$G_A.SubstRate.heavy,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$G_C.SubstRate.heavy,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$C_G.SubstRate.heavy,mutSpecAllMean$matur_tm, method = 'spearman')
mutSpecAllMeanNAzeroomit = mutSpecAllMean[!is.na(mutSpecAllMean$AGdivTC),]
summary(lm(formula = temperature ~ scale(A_G.SubstRate.heavy) + scale(C_T.SubstRate.heavy), data = mutSpecAllMean))
summary(lm(formula = A_G.SubstRate.heavy ~ scale(temperature) * scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = A_G.SubstRate.heavy ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = A_G.SubstRate.heavy ~ scale(temperature), data = mutSpecAllMean))
mutSpecAllMeanNAzeroomit = mutSpecAllMean[!is.na(mutSpecAllMean$AGdivTC),]
mutSpecAllMeanNAzeroomit = mutSpecAllMeanNAzeroomit[mutSpecAllMeanNAzeroomit$AGdivTC != 0,]
summary(lm(formula = AGdivTC ~ scale(temperature) * scale(matur_tm), data = mutSpecAllMeanNAzeroomit))
summary(lm(formula = AGdivTC ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMeanNAzeroomit))
summary(lm(formula = AGdivTC ~ scale(temperature), data = mutSpecAllMeanNAzeroomit))
tree = read.tree('../Data/1raw/mtalign.aln.treefile.rooted')
row.names(mutSpecAllMeanNAzeroomit) = mutSpecAllMeanNAzeroomit$Species
tree_pruned = treedata(tree, mutSpecAllMeanNAzeroomit, sort=T, warnings=T)$phy
data<-as.data.frame(treedata(tree_pruned, mutSpecAllMeanNAzeroomit, sort=T, warnings=T)$data)
data$Species = as.character(data$Species)
data$TCdivAG = as.numeric(as.character(data$AGdivTC))
data$temperature = as.numeric(as.character(data$temperature))
data$matur_tm = as.numeric(as.character(data$matur_tm))
data_comp <- comparative.data(tree_pruned, data, Species, vcv=TRUE)
summary(pgls(AGdivTC ~ scale(temperature), data_comp, lambda="ML"))
tree = read.tree('../Data/1raw/mtalign.aln.treefile.rooted')
row.names(mutSpecAllMeanNAzeroomit) = mutSpecAllMeanNAzeroomit$Species
tree_pruned = treedata(tree, mutSpecAllMeanNAzeroomit, sort=T, warnings=T)$phy
data<-as.data.frame(treedata(tree_pruned, mutSpecAllMeanNAzeroomit, sort=T, warnings=T)$data)
data$Species = as.character(data$Species)
data$AGdivTC = as.numeric(as.character(data$AGdivTC))
data$temperature = as.numeric(as.character(data$temperature))
data$matur_tm = as.numeric(as.character(data$matur_tm))
data_comp <- comparative.data(tree_pruned, data, Species, vcv=TRUE)
summary(pgls(AGdivTC ~ scale(temperature), data_comp, lambda="ML"))
summary(pgls(log2(AGdivTC) ~ log2(temperature), data_comp, lambda="ML"))
tree = read.tree('../Data/1raw/mtalign.aln.treefile.rooted')
row.names(mutSpecAllMeanNAzeroomit) = mutSpecAllMeanNAzeroomit$Species
tree_pruned = treedata(tree, mutSpecAllMeanNAzeroomit, sort=T, warnings=T)$phy
data<-as.data.frame(treedata(tree_pruned, mutSpecAllMeanNAzeroomit, sort=T, warnings=T)$data)
data$Species = as.character(data$Species)
data$AGdivTC = as.numeric(as.character(data$AGdivTC))
data$temperature = as.numeric(as.character(data$temperature))
data$matur_tm = as.numeric(as.character(data$matur_tm))
data_comp <- comparative.data(tree_pruned, data, Species, vcv=TRUE)
summary(pgls(AGdivTC ~ scale(temperature), data_comp, lambda="ML"))
summary(pgls(log2(AGdivTC) ~ log2(temperature), data_comp, lambda="ML"))
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = row.names(averageMutSpec2); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
row.names(averageMutSpec1)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec1)
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.heavy", "A_T.heavy", "A_C.heavy", "T_G.heavy", "T_A.heavy", "T_C.heavy", "G_T.heavy", "G_C.heavy", "G_A.heavy", "C_G.heavy", "C_T.heavy", "C_A.heavy"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec1)
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec
averageMutSpec1
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec1)
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
summary(averageMutSpec1)
summary(averageMutSpec1)
averageMutSpec1
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]; summary(averageMutSpec1)
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
table(mutSpecCytB[!is.na(mutSpecCytB$temperature),]$Class)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
View(averageMutSpec1)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
View(averageMutSpec1)
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean));
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean));
averageMutSpec2
row.names(averageMutSpec2)
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]; summary(averageMutSpec2)
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = c("A_C.h", "A_G.h", "A_T.h", "C_A.h", "C_G.h",
"C_T.h", "G_A.h", "G_C.h", "G_T.h", "T_A.h","T_C.h", "T_G.h"); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = c("A_C.h", "A_G.h", "A_T.h", "C_A.h", "C_G.h",
"C_T.h", "G_A.h", "G_C.h", "G_T.h", "T_A.h","T_C.h", "T_G.h"); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
row.names(averageMutSpec3)
averageMutSpec3 = mutSpecAllMeanBySums[,19:30]; summary(averageMutSpec3)
averageMutSpec3 = as.data.frame(apply(averageMutSpec3, 2, mean)); averageMutSpec3$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec3) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec3, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec3 = mutSpecAllMeanBySums[,19:30]
averageMutSpec3 = as.data.frame(apply(averageMutSpec3, 2, mean)); averageMutSpec3$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec3) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec3, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
