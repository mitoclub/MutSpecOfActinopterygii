cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf" | mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf" | mutSpecAllMean$CTdivGA == "NaN" | mutSpecAllMean$CTdivGA == NA,]$CTdivGA = NA
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$AGdivTC == "Inf" | mutSpecAllMean$AGdivTC == "NaN",]$AGdivTC
mutSpecAllMean$AGdivTC=mutSpecAllMean$A_G.SubstRate.heavy/mutSpecAllMean$T_C.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$AGdivTC == "Inf" | mutSpecAllMean$AGdivTC == "NaN",]$AGdivTC
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf" | mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA
View(mutSpecAllMean)
table(mutSpecAllMean$CTdivGA)
str(mutSpecAllMean$CTdivGA)
summary(mutSpecAllMean$CTdivGA)
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf" | mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA
View(mutSpecAllMean)
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf",]$CTdivGA
View(mutSpecAllMean)
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf",]$CTdivGA = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf" | | mutSpecAllMean$CTdivGA == Inf ,]$CTdivGA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf" | mutSpecAllMean$CTdivGA == Inf ,]$CTdivGA = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf" | mutSpecAllMean$CTdivGA == Inf ,]$CTdivGA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf",]$CTdivGA = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf",]$CTdivGA = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf",]$CTdivGA
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
summary(mutSpecAllMean$CTdivGA)
cor.test(mutSpecAllMean$CTdivGA,mutSpecAllMean$temperature, method = 'spearman')
summary(mutSpecAllMean$CTdivGA)
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf",]$CTdivGA = NA
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
summary(mutSpecAllMean$CTdivGA)
mutSpecAllMean$CTdivGA
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
table(mutSpecCytB[!is.na(mutSpecCytB$temperature),]$Class)
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.SubstRate.heavy=mean(A_C.SubstRate.heavy), A_G.SubstRate.heavy=mean(A_G.SubstRate.heavy), A_T.SubstRate.heavy=mean(A_T.SubstRate.heavy), C_A.SubstRate.heavy=mean(C_A.SubstRate.heavy), C_G.SubstRate.heavy=mean(C_G.SubstRate.heavy), C_T.SubstRate.heavy=mean(C_T.SubstRate.heavy), G_A.SubstRate.heavy=mean(G_A.SubstRate.heavy), G_C.SubstRate.heavy=mean(G_C.SubstRate.heavy), G_T.SubstRate.heavy=mean(G_T.SubstRate.heavy), T_A.SubstRate.heavy=mean(T_A.SubstRate.heavy), T_C.SubstRate.heavy=mean(T_C.SubstRate.heavy), T_G.SubstRate.heavy=mean(T_G.SubstRate.heavy))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = c("A_C.h", "A_G.h", "A_T.h", "C_A.h", "C_G.h",
"C_T.h", "G_A.h", "G_C.h", "G_T.h", "T_A.h","T_C.h", "T_G.h"); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
cor.test(mutSpecCytB$A_G.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_A.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_C.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_T.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecAllMean$A_G.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_A.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_C.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_T.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
mutSpecCytB$AGdivTC=mutSpecCytB$A_G.SubstRate.heavy/mutSpecCytB$T_C.SubstRate.heavy
mutSpecCytB[mutSpecCytB$AGdivTC == "Inf" | mutSpecCytB$AGdivTC == "NaN",]$AGdivTC = NA
cor.test(mutSpecCytB$AGdivTC,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$AGdivTC=mutSpecAllMean$A_G.SubstRate.heavy/mutSpecAllMean$T_C.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$AGdivTC == "Inf" | mutSpecAllMean$AGdivTC == "NaN",]$AGdivTC = NA
cor.test(mutSpecAllMean$AGdivTC,mutSpecAllMean$temperature, method = 'spearman')
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
mutSpecAllMean$CTdivGA
mutSpecAllMean$CTdivGA[!is.na(mutSpecAllMean$CTdivGA)]
mutSpecAllMean$CTdivGA[!is.na(mutSpecAllMean$CTdivGA)][mutSpecAllMean$CTdivGA == "Inf",]$CTdivGA
mutSpecAllMean$CTdivGA[!is.na(mutSpecAllMean$CTdivGA)]
mutSpecAllMean$CTdivGA[!is.na(mutSpecAllMean$CTdivGA)][mutSpecAllMean$CTdivGA[!is.na(mutSpecAllMean$CTdivGA)]$CTdivGA == "Inf",]$CTdivGA
mutSpecAllMean[mutSpecAllMean$CTdivGA[!is.na(mutSpecAllMean$CTdivGA)]$CTdivGA == "Inf",]$CTdivGA
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA)]$CTdivGA == "Inf"
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA)]$CTdivGA
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]
mutSpecAllMean[mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA == "Inf",]
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA == "Inf"
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),][mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA == "Inf",]
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),][mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA == "Inf",]$CTdivGA = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Nan",]$CTdivGA = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Nan",]$CTdivGA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA = NA
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),][mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA == "Inf",]$CTdivGA = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA = NA
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),][mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA == "Inf",]$CTdivGA = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),][mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecAllMean$CTdivGA,mutSpecAllMean$temperature, method = 'spearman')
View(mutSpecAllMean)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
table(mutSpecCytB[!is.na(mutSpecCytB$temperature),]$Class)
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.SubstRate.heavy=mean(A_C.SubstRate.heavy), A_G.SubstRate.heavy=mean(A_G.SubstRate.heavy), A_T.SubstRate.heavy=mean(A_T.SubstRate.heavy), C_A.SubstRate.heavy=mean(C_A.SubstRate.heavy), C_G.SubstRate.heavy=mean(C_G.SubstRate.heavy), C_T.SubstRate.heavy=mean(C_T.SubstRate.heavy), G_A.SubstRate.heavy=mean(G_A.SubstRate.heavy), G_C.SubstRate.heavy=mean(G_C.SubstRate.heavy), G_T.SubstRate.heavy=mean(G_T.SubstRate.heavy), T_A.SubstRate.heavy=mean(T_A.SubstRate.heavy), T_C.SubstRate.heavy=mean(T_C.SubstRate.heavy), T_G.SubstRate.heavy=mean(T_G.SubstRate.heavy))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = c("A_C.h", "A_G.h", "A_T.h", "C_A.h", "C_G.h",
"C_T.h", "G_A.h", "G_C.h", "G_T.h", "T_A.h","T_C.h", "T_G.h"); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
cor.test(mutSpecCytB$A_G.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_A.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_C.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_T.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecAllMean$A_G.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_A.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_C.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_T.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
mutSpecCytB$AGdivTC=mutSpecCytB$A_G.SubstRate.heavy/mutSpecCytB$T_C.SubstRate.heavy
mutSpecCytB[mutSpecCytB$AGdivTC == "Inf" | mutSpecCytB$AGdivTC == "NaN",]$AGdivTC = NA
cor.test(mutSpecCytB$AGdivTC,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$AGdivTC=mutSpecAllMean$A_G.SubstRate.heavy/mutSpecAllMean$T_C.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$AGdivTC == "Inf" | mutSpecAllMean$AGdivTC == "NaN",]$AGdivTC = NA
cor.test(mutSpecAllMean$AGdivTC,mutSpecAllMean$temperature, method = 'spearman')
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),][mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA == "Inf",]$CTdivGA = NA
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),][mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecAllMean$CTdivGA,mutSpecAllMean$temperature, method = 'spearman')
View(mutSpecAllMean)
summary(mutSpecAllMean$CTdivGA)
mutSpecAllMean[mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA
mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),][mutSpecAllMean[!is.na(mutSpecAllMean$CTdivGA),]$CTdivGA == "NaN",]$CTdivGA = NA
table(mutSpecAllMean$CTdivGA)
cor.test(mutSpecAllMean$CTdivGA,mutSpecAllMean$temperature, method = 'spearman')
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
cor.test(mutSpecAllMean$CTdivGA,mutSpecAllMean$temperature, method = 'spearman')
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
table(mutSpecCytB[!is.na(mutSpecCytB$temperature),]$Class)
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.SubstRate.heavy=mean(A_C.SubstRate.heavy), A_G.SubstRate.heavy=mean(A_G.SubstRate.heavy), A_T.SubstRate.heavy=mean(A_T.SubstRate.heavy), C_A.SubstRate.heavy=mean(C_A.SubstRate.heavy), C_G.SubstRate.heavy=mean(C_G.SubstRate.heavy), C_T.SubstRate.heavy=mean(C_T.SubstRate.heavy), G_A.SubstRate.heavy=mean(G_A.SubstRate.heavy), G_C.SubstRate.heavy=mean(G_C.SubstRate.heavy), G_T.SubstRate.heavy=mean(G_T.SubstRate.heavy), T_A.SubstRate.heavy=mean(T_A.SubstRate.heavy), T_C.SubstRate.heavy=mean(T_C.SubstRate.heavy), T_G.SubstRate.heavy=mean(T_G.SubstRate.heavy))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = c("A_C.h", "A_G.h", "A_T.h", "C_A.h", "C_G.h",
"C_T.h", "G_A.h", "G_C.h", "G_T.h", "T_A.h","T_C.h", "T_G.h"); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
cor.test(mutSpecCytB$A_G.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_A.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_C.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_T.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecAllMean$A_G.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_A.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_C.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_T.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
mutSpecCytB$AGdivTC=mutSpecCytB$A_G.SubstRate.heavy/mutSpecCytB$T_C.SubstRate.heavy
mutSpecCytB[mutSpecCytB$AGdivTC == "Inf" | mutSpecCytB$AGdivTC == "NaN",]$AGdivTC = NA
cor.test(mutSpecCytB$AGdivTC,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$AGdivTC=mutSpecAllMean$A_G.SubstRate.heavy/mutSpecAllMean$T_C.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$AGdivTC == "Inf" | mutSpecAllMean$AGdivTC == "NaN",]$AGdivTC = NA
cor.test(mutSpecAllMean$AGdivTC,mutSpecAllMean$temperature, method = 'spearman')
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
cor.test(mutSpecAllMean$CTdivGA,mutSpecAllMean$temperature, method = 'spearman')
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$AGdivTC=mutSpecAllMean$A_G.SubstRate.heavy/mutSpecAllMean$T_C.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$AGdivTC == "Inf" | mutSpecAllMean$AGdivTC == "NaN",]$AGdivTC = NA
cor.test(mutSpecAllMean$AGdivTC,mutSpecAllMean$temperature, method = 'spearman')
View(mutSpecAllMean)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
table(mutSpecCytB[!is.na(mutSpecCytB$temperature),]$Class)
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.SubstRate.heavy=mean(A_C.SubstRate.heavy), A_G.SubstRate.heavy=mean(A_G.SubstRate.heavy), A_T.SubstRate.heavy=mean(A_T.SubstRate.heavy), C_A.SubstRate.heavy=mean(C_A.SubstRate.heavy), C_G.SubstRate.heavy=mean(C_G.SubstRate.heavy), C_T.SubstRate.heavy=mean(C_T.SubstRate.heavy), G_A.SubstRate.heavy=mean(G_A.SubstRate.heavy), G_C.SubstRate.heavy=mean(G_C.SubstRate.heavy), G_T.SubstRate.heavy=mean(G_T.SubstRate.heavy), T_A.SubstRate.heavy=mean(T_A.SubstRate.heavy), T_C.SubstRate.heavy=mean(T_C.SubstRate.heavy), T_G.SubstRate.heavy=mean(T_G.SubstRate.heavy))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = c("A_C.h", "A_G.h", "A_T.h", "C_A.h", "C_G.h",
"C_T.h", "G_A.h", "G_C.h", "G_T.h", "T_A.h","T_C.h", "T_G.h"); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
cor.test(mutSpecCytB$A_G.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_A.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_C.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_T.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecAllMean$A_G.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_A.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_C.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_T.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
mutSpecCytB$AGdivTC=mutSpecCytB$A_G.SubstRate.heavy/mutSpecCytB$T_C.SubstRate.heavy
mutSpecCytB[mutSpecCytB$AGdivTC == "Inf" | mutSpecCytB$AGdivTC == "NaN",]$AGdivTC = NA
cor.test(mutSpecCytB$AGdivTC,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$AGdivTC=mutSpecAllMean$A_G.SubstRate.heavy/mutSpecAllMean$T_C.SubstRate.heavy
View(mutSpecAllMean)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
table(mutSpecCytB[!is.na(mutSpecCytB$temperature),]$Class)
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.SubstRate.heavy=mean(A_C.SubstRate.heavy), A_G.SubstRate.heavy=mean(A_G.SubstRate.heavy), A_T.SubstRate.heavy=mean(A_T.SubstRate.heavy), C_A.SubstRate.heavy=mean(C_A.SubstRate.heavy), C_G.SubstRate.heavy=mean(C_G.SubstRate.heavy), C_T.SubstRate.heavy=mean(C_T.SubstRate.heavy), G_A.SubstRate.heavy=mean(G_A.SubstRate.heavy), G_C.SubstRate.heavy=mean(G_C.SubstRate.heavy), G_T.SubstRate.heavy=mean(G_T.SubstRate.heavy), T_A.SubstRate.heavy=mean(T_A.SubstRate.heavy), T_C.SubstRate.heavy=mean(T_C.SubstRate.heavy), T_G.SubstRate.heavy=mean(T_G.SubstRate.heavy))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = c("A_C.h", "A_G.h", "A_T.h", "C_A.h", "C_G.h",
"C_T.h", "G_A.h", "G_C.h", "G_T.h", "T_A.h","T_C.h", "T_G.h"); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
cor.test(mutSpecCytB$A_G.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_A.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_C.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_T.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecAllMean$A_G.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_A.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_C.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_T.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
summary(C_T.SubstRate.heavy)
summary(mutSpecCytB$C_T.SubstRate.heavy)
summary(mutSpecCytB$G_A.SubstRate.heavy)
mutSpecCytB$AGdivTC=mutSpecCytB$A_G.SubstRate.heavy/mutSpecCytB$T_C.SubstRate.heavy
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
mutSpecCytB[mutSpecCytB$AGdivTC == "Inf" | mutSpecCytB$AGdivTC == "NaN",]$AGdivTC = NA
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecCytB$AGdivTC,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$AGdivTC=mutSpecAllMean$A_G.SubstRate.heavy/mutSpecAllMean$T_C.SubstRate.heavy
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$AGdivTC == "Inf" | mutSpecAllMean$AGdivTC == "NaN",]$AGdivTC = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf" | mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA = NA
summary(mutSpecAllMean$C_T.SubstRate.heavy)
View(mutSpecAllMean)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
table(mutSpecCytB[!is.na(mutSpecCytB$temperature),]$Class)
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.SubstRate.heavy=mean(A_C.SubstRate.heavy), A_G.SubstRate.heavy=mean(A_G.SubstRate.heavy), A_T.SubstRate.heavy=mean(A_T.SubstRate.heavy), C_A.SubstRate.heavy=mean(C_A.SubstRate.heavy), C_G.SubstRate.heavy=mean(C_G.SubstRate.heavy), C_T.SubstRate.heavy=mean(C_T.SubstRate.heavy), G_A.SubstRate.heavy=mean(G_A.SubstRate.heavy), G_C.SubstRate.heavy=mean(G_C.SubstRate.heavy), G_T.SubstRate.heavy=mean(G_T.SubstRate.heavy), T_A.SubstRate.heavy=mean(T_A.SubstRate.heavy), T_C.SubstRate.heavy=mean(T_C.SubstRate.heavy), T_G.SubstRate.heavy=mean(T_G.SubstRate.heavy))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = c("A_C.h", "A_G.h", "A_T.h", "C_A.h", "C_G.h",
"C_T.h", "G_A.h", "G_C.h", "G_T.h", "T_A.h","T_C.h", "T_G.h"); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
cor.test(mutSpecCytB$A_G.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_A.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_C.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_T.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean[!is.na(mutSpecAllMean$C_T.SubstRate.heavy),]
cor.test(mutSpecAllMean$A_G.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_A.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_C.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_T.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
mutSpecCytB$AGdivTC=mutSpecCytB$A_G.SubstRate.heavy/mutSpecCytB$T_C.SubstRate.heavy
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
mutSpecCytB[mutSpecCytB$AGdivTC == "Inf" | mutSpecCytB$AGdivTC == "NaN",]$AGdivTC = NA
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecCytB$AGdivTC,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$AGdivTC=mutSpecAllMean$A_G.SubstRate.heavy/mutSpecAllMean$T_C.SubstRate.heavy
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$AGdivTC == "Inf" | mutSpecAllMean$AGdivTC == "NaN",]$AGdivTC = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf" | mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA = NA
summary(mutSpecAllMean$C_T.SubstRate.heavy)
mutSpecAllMean[!is.na(mutSpecAllMean$C_T.SubstRate.heavy),]
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
table(mutSpecCytB[!is.na(mutSpecCytB$temperature),]$Class)
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.SubstRate.heavy=mean(A_C.SubstRate.heavy), A_G.SubstRate.heavy=mean(A_G.SubstRate.heavy), A_T.SubstRate.heavy=mean(A_T.SubstRate.heavy), C_A.SubstRate.heavy=mean(C_A.SubstRate.heavy), C_G.SubstRate.heavy=mean(C_G.SubstRate.heavy), C_T.SubstRate.heavy=mean(C_T.SubstRate.heavy), G_A.SubstRate.heavy=mean(G_A.SubstRate.heavy), G_C.SubstRate.heavy=mean(G_C.SubstRate.heavy), G_T.SubstRate.heavy=mean(G_T.SubstRate.heavy), T_A.SubstRate.heavy=mean(T_A.SubstRate.heavy), T_C.SubstRate.heavy=mean(T_C.SubstRate.heavy), T_G.SubstRate.heavy=mean(T_G.SubstRate.heavy))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
averageMutSpec1 = mutSpecCytB[!is.na(mutSpecCytB$temperature),][,26:37]
averageMutSpec1 = as.data.frame(apply(averageMutSpec1, 2, mean)); averageMutSpec1$Subs = c("A_G.h", "A_T.h", "A_C.h", "T_G.h", "T_A.h", "T_C.h", "G_T.h", "G_C.h", "G_A.h", "C_G.h", "C_T.h", "C_A.h"); names(averageMutSpec1) = c("Freq", "Subs")
f1 = ggbarplot(averageMutSpec1, x = "Subs", y = "Freq", fill = "Subs", color = "Subs",
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
averageMutSpec2 = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),][,5:16]
averageMutSpec2 = averageMutSpec2[!is.na(averageMutSpec2$C_A.SubstRate.heavy) & !is.na(averageMutSpec2$C_G.SubstRate.heavy) & !is.na(averageMutSpec2$C_T.SubstRate.heavy),]
averageMutSpec2 = as.data.frame(apply(averageMutSpec2, 2, mean)); averageMutSpec2$Subs = c("A_C.h", "A_G.h", "A_T.h", "C_A.h", "C_G.h",
"C_T.h", "G_A.h", "G_C.h", "G_T.h", "T_A.h","T_C.h", "T_G.h"); names(averageMutSpec2) = c("Freq", "Subs")
pdf('../Figures/PolymorphicData.Actinopterygii.AverageMutSpec.pdf')
f1 = ggbarplot(averageMutSpec2, x = "Subs", y = "Freq", fill = "Subs", color = "Subs", palette = c("#bdbdbd", "#73514f", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#055088", "#9c3d37", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#036a5b", "#bdbdbd"),
xlab="Substitution types", ylab="Normalised frequencies", legend = "none")
f1
dev.off()
f1
cor.test(mutSpecCytB$A_G.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_A.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_C.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_T.SubstRate.heavy,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$C_T.SubstRate.heavy),]
cor.test(mutSpecAllMean$A_G.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_A.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_C.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_T.SubstRate.heavy,mutSpecAllMean$temperature, method = 'spearman')
mutSpecCytB$AGdivTC=mutSpecCytB$A_G.SubstRate.heavy/mutSpecCytB$T_C.SubstRate.heavy
mutSpecCytB$CTdivGA=mutSpecCytB$C_T.SubstRate.heavy/mutSpecCytB$G_A.SubstRate.heavy
mutSpecCytB[mutSpecCytB$AGdivTC == "Inf" | mutSpecCytB$AGdivTC == "NaN",]$AGdivTC = NA
mutSpecCytB[mutSpecCytB$CTdivGA == "Inf" | mutSpecCytB$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecCytB$AGdivTC,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$CTdivGA,mutSpecCytB$temperature, method = 'spearman')
mutSpecAllMean$AGdivTC=mutSpecAllMean$A_G.SubstRate.heavy/mutSpecAllMean$T_C.SubstRate.heavy
mutSpecAllMean$CTdivGA=mutSpecAllMean$C_T.SubstRate.heavy/mutSpecAllMean$G_A.SubstRate.heavy
mutSpecAllMean[mutSpecAllMean$AGdivTC == "Inf" | mutSpecAllMean$AGdivTC == "NaN",]$AGdivTC = NA
mutSpecAllMean[mutSpecAllMean$CTdivGA == "Inf" | mutSpecAllMean$CTdivGA == "NaN",]$CTdivGA = NA
cor.test(mutSpecAllMean$AGdivTC,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$CTdivGA,mutSpecAllMean$temperature, method = 'spearman')
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "A_G.SubstRate.heavy",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 AH>GH") + stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
f1b1 = ggscatter(mutSpecAllMean, x = "temperature", y = "C_T.SubstRate.heavy",
color = "#055088", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 CH>TH")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1b1
f1b2 = ggscatter(mutSpecAllMean, x = "temperature", y = "G_A.SubstRate.heavy",
color = "#9c3d37", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 GH>AH")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1b2
f1c = ggscatter(mutSpecAllMean, x = "temperature", y = "AGdivTC",
color = "#814194", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 A_GdivT_C")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1c
cor.test(mutSpecAllMean$A_G.SubstRate.heavy,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$G_A.SubstRate.heavy,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$G_C.SubstRate.heavy,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$C_G.SubstRate.heavy,mutSpecAllMean$matur_tm, method = 'spearman')
rm(list=ls(all=TRUE))
library(ggplot2)
MUT = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
taxa = read.table("../../Body/1Raw/TaxaFromKostya.Names.stat", sep = '\t',header = FALSE)
rm(list=ls(all=TRUE))
library(ggplot2)
MUT = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
taxa = read.table("../Data/1raw/TaxaFromKostya.Names.stat", sep = '\t',header = FALSE)
taxa = as.data.frame(taxa[grepl('Actinopteri',taxa$V1),])
names(taxa) = 'taxa'
taxa$Species = gsub(";(.*)",'',taxa$taxa);
taxa$Species = gsub(" ",'_',taxa$Species);
taxa$Family = gsub(";Actinopteri(.*)",'',taxa$taxa)
taxa$Family = gsub("(.*);",'',taxa$Family)
table(taxa$Family) ### some species with freq of families > 3
length(unique(taxa$Family)) ### 43 Families
taxa = taxa[,-1]
### merge Taxa with Temp and MutSpec
finaldf = merge(TemperMut, taxa, by = 'Species')
rm(list=ls(all=TRUE))
library(ggplot2)
MUT = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
taxa = read.table("../Data/1raw/TaxaFromKostya.Names.stat", sep = '\t',header = FALSE)
taxa = as.data.frame(taxa[grepl('Actinopteri',taxa$V1),])
names(taxa) = 'taxa'
taxa$Species = gsub(";(.*)",'',taxa$taxa);
taxa$Species = gsub(" ",'_',taxa$Species);
taxa$Family = gsub(";Actinopteri(.*)",'',taxa$taxa)
taxa$Family = gsub("(.*);",'',taxa$Family)
table(taxa$Family) ### some species with freq of families > 3
length(unique(taxa$Family)) ### 43 Families
taxa = taxa[,-1]
### merge Taxa with Temp and MutSpec
finaldf = merge(MUT, taxa, by = 'Species')
nrow(finaldf) # 110 sps with all inf
for (i in 1:nrow(finaldf))   {  finaldf$FamilyShort[i] = paste(unlist(strsplit(finaldf$Family[i],''))[c(1:3)],collapse = '')  } # make Short names
table(finaldf$Family)
length(unique(finaldf$Family))# 30 families
FamFreq = data.frame(table(finaldf$Family));
FrequentFamilies = FamFreq[FamFreq$Freq >= 3,]$Var1; length(FrequentFamilies) # delete families, that have less than 3 species!!!
FamFreq = FamFreq[FamFreq$Var1 %in% FrequentFamilies,]
names(FamFreq)=c('Family','NumberOfSpecies')
Fishes = finaldf[finaldf$Family %in% FrequentFamilies,]
Fishes$TsTv = (Fishes$T_C + Fishes$C_T + Fishes$G_A + Fishes$A_G) / (Fishes$T_A + Fishes$A_T + Fishes$G_C + Fishes$C_G + Fishes$G_T + Fishes$T_G + Fishes$C_A + Fishes$A_C)
View(finaldf)
