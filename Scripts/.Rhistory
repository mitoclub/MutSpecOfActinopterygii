rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(ggplot2)) install.packages("ggplot2")
if (!require(hrbrthemes)) install.packages("hrbrthemes")
library(caper)
library(geiger)
library("ggpubr")
library(ggplot2)
library(hrbrthemes)
hrbrthemes::import_roboto_condensed()
##########Reading MutSpec DataBase with temp and mt of Actinopterigii
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
table(mutSpec$Class)
#####correlation of mutspec with temperature in fishes
cor.test(mutSpec$A_T.N,mutSpec$temperature, method = 'spearman')   #rho
cor.test(mutSpec$A_G.N,mutSpec$temperature, method = 'spearman')   #rho     0.082413817 p-value = 0.08041
cor.test(mutSpec$A_C.N,mutSpec$temperature, method = 'spearman')   #rho
cor.test(mutSpec$T_A.N,mutSpec$temperature, method = 'spearman')   #rho
cor.test(mutSpec$T_G.N,mutSpec$temperature, method = 'spearman')   #rho
cor.test(mutSpec$T_C.N,mutSpec$temperature, method = 'spearman')   #rho     0.3427546 p-value = 7.059e-14
cor.test(mutSpec$G_A.N,mutSpec$temperature, method = 'spearman')   #rho
cor.test(mutSpec$G_T.N,mutSpec$temperature, method = 'spearman')   #rho
cor.test(mutSpec$G_C.N,mutSpec$temperature, method = 'spearman')   #rho
cor.test(mutSpec$C_A.N,mutSpec$temperature, method = 'spearman')   #rho
cor.test(mutSpec$C_T.N,mutSpec$temperature, method = 'spearman')   #rho
cor.test(mutSpec$C_G.N,mutSpec$temperature, method = 'spearman')   #rho
f3 = ggscatter(mutSpec, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="AH>GH")
ggpar(f3, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$T_C.N)+1))
f3 + stat_cor(method = "pearson", label.x = 3, label.y = 30)
f3 + stat_cor(method = "spearman")
#pdf("../../Body/4Figures/VertebratePolymorphisms.MutSpecComparisons.Analyses.Ecology.Actinopterygii.FishBaseData.FIGURE1B.pdf")
f3 = ggscatter(mutSpec, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="AH>GH") + stat_cor(method = "spearman")
ggpar(f3, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$T_C.N)+1))
ggpar(f3, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$T_C.N)+1)) + stat_cor(method = "spearman")
##Figures
samplesize = nrow(mutSpec[!is.na(mutSpec$temperature),]))
##Figures
samplesize = nrow(mutSpec[!is.na(mutSpec$temperature),])
nrow(mutSpec[!is.na(mutSpec$temperature),])
ggscatter(mutSpec, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="TH>CH")
ggpar(f1b, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$A_G.N)+1))
f1b = ggscatter(mutSpec, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="TH>CH")
ggpar(f1b, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$A_G.N)+1))
pdf('../Data/VertebratePolymorphisms.MutSpecData.Actinopterygii.pdf')
pdf('../Data/VertebratePolymorphisms.MutSpecData.Actinopterygii.pdf')
f1a = ggscatter(mutSpec, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="AH>GH")
ggpar(f1a, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$T_C.N)+1))
f1b = ggscatter(mutSpec, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="TH>CH")
ggpar(f1b, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$A_G.N)+1))
dev.off()
pdf('../Figures/VertebratePolymorphisms.MutSpecData.Actinopterygii.pdf')
f1a = ggscatter(mutSpec, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="AH>GH")
ggpar(f1a, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$T_C.N)+1))
f1b = ggscatter(mutSpec, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="TH>CH")
ggpar(f1b, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$A_G.N)+1))
dev.off()
f1b = ggscatter(mutSpec, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="TH>CH") + stat_cor(method = "pearson")
f1b
ggpar(f1b, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$A_G.N)+1))
f1b = ggscatter(mutSpec, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="TH>CH")
ggpar(f1b, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$A_G.N)+1)) + stat_cor(method = "pearson")
f1b + stat_cor(method = "pearson")
f1b = ggscatter(mutSpec, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="TH>CH")
ggpar(f1b, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$A_G.N)+1))
f1b + stat_cor(method = "pearson")
f1b = ggscatter(mutSpec, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="TH>CH")
ggpar(f1b, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$A_G.N)+1))
knitr::opts_chunk$set(echo = TRUE)
f1a = ggscatter(mutSpec, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="AH>GH")
ggpar(f1a, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$T_C.N)+1))
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(ggplot2)) install.packages("ggplot2")
if (!require(hrbrthemes)) install.packages("hrbrthemes")
library(caper)
library(geiger)
library("ggpubr")
library(ggplot2)
library(hrbrthemes)
hrbrthemes::import_roboto_condensed()
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
cor.test(mutSpec$A_T.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$A_G.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$A_C.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$T_A.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$T_G.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$T_C.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$G_A.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$G_T.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$G_C.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$C_A.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$C_T.N,mutSpec$temperature, method = 'spearman')
cor.test(mutSpec$C_G.N,mutSpec$temperature, method = 'spearman')
f1a = ggscatter(mutSpec, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="AH>GH")
ggpar(f1a, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$T_C.N)+1))
f1a = ggscatter(mutSpec, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="AH>GH")
ggpar(f1a, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$T_C.N)+1))
f1a = ggscatter(mutSpec, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="AH>GH")
ggpar(f1a, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$T_C.N)+1))
f1b = ggscatter(mutSpec, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="TH>CH")
ggpar(f1b, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$A_G.N)+1))
f1a = ggscatter(mutSpec, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Mean annual water temperature, ?C", ylab="AH>GH")
ggpar(f1a, ylim = c(0, max(mutSpec[!is.na(mutSpec$temperature),]$T_C.N)+1))
View(mutSpec)
nrow(mutSpec[!is.na(mutSpec$temperature),]$Species)
mutSpec[!is.na(mutSpec$temperature),]$Species
##Figures
samplesize = length(unique(mutSpec[!is.na(mutSpec$temperature),]$Species))
samplesize
View(mutSpec)
