color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(aes(label = paste(..r.label.., ..p.label.., ..N.., sep = ",")))
f1a
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~,~")))
f1a
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(aes(label = paste(..r.label.., ..p.label.., ..N=.., sep = "~`,`~")))
f1a
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(aes(label = paste(..r.label.., ..p.label.., ..N/=.., sep = "~`,`~")))
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(aes(label = paste(..r.label.., ..p.label.., ..N\=.., sep = "~`,`~")))
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
cor.test(mutSpecAllMean$T_C.N,mutSpecAllMean$temperature, method = 'spearman')
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
cor.test(mutSpecAllMean$T_C.N,mutSpecAllMean$temperature, method = 'spearman')
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
cor.test(mutSpecAllMean$T_C.N,mutSpecAllMean$temperature, method = 'spearman')
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
cor.test(mutSpecAllMean$T_C.N,mutSpecAllMean$temperature, method = 'spearman')
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(method = "pearson", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
cor.test(mutSpecAllMean$T_C.N,mutSpecAllMean$temperature, method = 'spearman')
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
f1b = ggscatter(mutSpecAllMean, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="TH>CH")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1b
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
##########Reading MutSpec DataBase with temp and mt of Actinopterigii
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
table(mutSpec$Class)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.N=mean(A_C.N), A_G.N=mean(A_G.N), A_T.N=mean(A_T.N), C_A.N=mean(C_A.N), C_G.N=mean(C_G.N), C_T.N=mean(C_T.N), G_A.N=mean(G_A.N), G_C.N=mean(G_C.N), G_T.N=mean(G_T.N), T_A.N=mean(T_A.N), T_C.N=mean(T_C.N), T_G.N=mean(T_G.N))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
#only CytB
cor.test(mutSpecCytB$A_T.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$A_G.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$A_C.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_A.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_G.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_C.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_A.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_T.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_C.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_A.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_T.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_G.N,mutSpecCytB$temperature, method = 'spearman')
#all by mean
cor.test(mutSpecAllMean$A_T.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$A_G.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$A_C.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_A.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_G.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_C.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_A.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_T.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_C.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_A.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_T.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_G.N,mutSpecAllMean$temperature, method = 'spearman')
##Figures
pdf('../Figures/VertebratePolymorphisms.MutSpecData.Actinopterygii.pdf')
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
cor.test(mutSpecAllMean$T_C.N,mutSpecAllMean$temperature, method = 'spearman')
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
f1b = ggscatter(mutSpecAllMean, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="TH>CH")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1b
dev.off()
View(mutSpecAllMean)
cor.test(mutSpecAllMean$A_T.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$A_G.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$A_C.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$T_A.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$T_G.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$T_C.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$G_A.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$G_T.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$G_C.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$C_A.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$C_T.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$C_G.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$A_T.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$A_G.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$A_C.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$T_A.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$T_G.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$T_C.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$G_A.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$G_T.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$G_C.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$C_A.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$C_T.N,mutSpecAllMean$matur_tm, method = 'spearman')
cor.test(mutSpecAllMean$C_G.N,mutSpecAllMean$matur_tm, method = 'spearman')
f1b = ggscatter(mutSpecAllMean, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="TH>CH")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1b
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
##########Reading MutSpec DataBase with temp and mt of Actinopterigii
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
table(mutSpec$Class)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.N=mean(A_C.N), A_G.N=mean(A_G.N), A_T.N=mean(A_T.N), C_A.N=mean(C_A.N), C_G.N=mean(C_G.N), C_T.N=mean(C_T.N), G_A.N=mean(G_A.N), G_C.N=mean(G_C.N), G_T.N=mean(G_T.N), T_A.N=mean(T_A.N), T_C.N=mean(T_C.N), T_G.N=mean(T_G.N))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
summary(lm(formula = temperature ~ scale(T_C.N) + scale(A_G.N), data = mutSpecAllMean))
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/allparameters$A_G.N
######### TC / AG rank corr and log2 models
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/mutSpecAllMean$A_G.N
View(mutSpecAllMean)
######### TC / AG rank corr and log2 models
mutSpecAllMean = mutSpecAllMean[mutSpecAllMean$A_G.N != 0,]
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/mutSpecAllMean$A_G.N
cor.test(allparameters$TCdivAG,allparameters$Temperature, method = 'spearman')
cor.test(mutSpecAllMean$TCdivAG,mutSpecAllMean$Temperature, method = 'spearman')
cor.test(mutSpecAllMean$TCdivAG,mutSpecAllMean$temperature, method = 'spearman')
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.N=mean(A_C.N), A_G.N=mean(A_G.N), A_T.N=mean(A_T.N), C_A.N=mean(C_A.N), C_G.N=mean(C_G.N), C_T.N=mean(C_T.N), G_A.N=mean(G_A.N), G_C.N=mean(G_C.N), G_T.N=mean(G_T.N), T_A.N=mean(T_A.N), T_C.N=mean(T_C.N), T_G.N=mean(T_G.N))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
cor.test(mutSpecCytB$A_T.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$A_G.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$A_C.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_A.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_G.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$T_C.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_A.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_T.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$G_C.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_A.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_T.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecCytB$C_G.N,mutSpecCytB$temperature, method = 'spearman')
cor.test(mutSpecAllMean$A_T.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$A_G.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$A_C.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_A.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_G.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$T_C.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_A.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_T.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$G_C.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_A.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_T.N,mutSpecAllMean$temperature, method = 'spearman')
cor.test(mutSpecAllMean$C_G.N,mutSpecAllMean$temperature, method = 'spearman')
mutSpecAllMean = mutSpecAllMean[mutSpecAllMean$A_G.N != 0,]
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/mutSpecAllMean$A_G.N
cor.test(mutSpecAllMean$TCdivAG,mutSpecAllMean$temperature, method = 'spearman')
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
f1b = ggscatter(mutSpecAllMean, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="TH>CH")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1b
f1c = ggscatter(mutSpecAllMean, x = "temperature", y = "TCdivAG",
color = "#814194", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 A_GdivT_C")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1c
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
table(mutSpec$Class)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.N=mean(A_C.N), A_G.N=mean(A_G.N), A_T.N=mean(A_T.N), C_A.N=mean(C_A.N), C_G.N=mean(C_G.N), C_T.N=mean(C_T.N), G_A.N=mean(G_A.N), G_C.N=mean(G_C.N), G_T.N=mean(G_T.N), T_A.N=mean(T_A.N), T_C.N=mean(T_C.N), T_G.N=mean(T_G.N))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
rm(list=ls(all=TRUE))
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
table(mutSpec$Class)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.N=mean(A_C.N), A_G.N=mean(A_G.N), A_T.N=mean(A_T.N), C_A.N=mean(C_A.N), C_G.N=mean(C_G.N), C_T.N=mean(C_T.N), G_A.N=mean(G_A.N), G_C.N=mean(G_C.N), G_T.N=mean(G_T.N), T_A.N=mean(T_A.N), T_C.N=mean(T_C.N), T_G.N=mean(T_G.N))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/mutSpecAllMean$A_G.N
mutSpecAllMean[mutSpecAllMean$TCdivAG == Inf,]$TCdivAG = NA
mutSpecAllMean[mutSpecAllMean$TCdivAG == Inf,]$TCdivAG
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/mutSpecAllMean$A_G.N
mutSpecAllMean$TCdivAG
mutSpecAllMean[mutSpecAllMean$TCdivAG == Inf,]
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf",]$TCdivAG
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf",]$TCdivAG == "NA"
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf",]$TCdivAG == "NA"
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf",]$TCdivAG = "NA"
View(mutSpecAllMean)
mutSpecAllMean[mutSpecAllMean$TCdivAG != "Inf",]$TCdivAG
mutSpecAllMean[mutSpecAllMean$TCdivAG != "Inf" & mutSpecAllMean$TCdivAG != "NaN",]$TCdivAG
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf" & mutSpecAllMean$TCdivAG == "NaN",]$TCdivAG
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf" | mutSpecAllMean$TCdivAG == "NaN",]$TCdivAG
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf" | mutSpecAllMean$TCdivAG == "NaN",]$TCdivAG = 0
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf" | mutSpecAllMean$TCdivAG == "NaN",]$TCdivAG
######### TC / AG rank corr and log2 models
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/mutSpecAllMean$A_G.N
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf" | mutSpecAllMean$TCdivAG == "NaN",]$TCdivAG = NA
cor.test(mutSpecAllMean$TCdivAG,mutSpecAllMean$temperature, method = 'spearman')
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/mutSpecAllMean$A_G.N
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf" | mutSpecAllMean$TCdivAG == "NaN",]$TCdivAG = NA
cor.test(mutSpecAllMean$TCdivAG,mutSpecAllMean$temperature, method = 'spearman')
mutSpecAllMean = mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]; N = as.character(paste("N", nrow(mutSpecAllMean), sep="")) #delete NA
f1a = ggscatter(mutSpecAllMean, x = "temperature", y = "T_C.N",
color = "#036a5b", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="AH>GH") + stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1a
f1b = ggscatter(mutSpecAllMean, x = "temperature", y = "A_G.N",
color = "#73514f", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
xlab="Median annual water temperature, ?C", ylab="TH>CH")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1b
f1c = ggscatter(mutSpecAllMean, x = "temperature", y = "TCdivAG",
color = "#814194", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 A_GdivT_C")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1c
pdf('../Figures/VertebratePolymorphisms.MutSpecData.Actinopterygii.AGTCpdf')
f1c = ggscatter(mutSpecAllMean, x = "temperature", y = "TCdivAG",
color = "#814194", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 A_GdivT_C")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1c
dev.off()
pdf('../Figures/VertebratePolymorphisms.MutSpecData.Actinopterygii.AGTC.pdf')
f1c = ggscatter(mutSpecAllMean, x = "temperature", y = "TCdivAG",
color = "#814194", # Points color, shape and size
add = "reg.line",  # Add regressin line
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
conf.int = TRUE, # Add confidence interval
yscale = "log2", xlab="Median annual water temperature, ?C", ylab="log2 A_GdivT_C")+ stat_cor(method = "spearman", aes(label = paste(..r.label.., ..p.label.., ..N.., sep = "~`,`~")))
f1c
dev.off()
summary(lm(formula = temperature ~ scale(T_C.N) + scale(A_G.N), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) * scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = temperature ~ scale(T_C.N) + scale(A_G.N), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) * scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMean))
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/mutSpecAllMean$A_G.N
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf" | mutSpecAllMean$TCdivAG == "NaN",]$TCdivAG = NA
cor.test(mutSpecAllMean$TCdivAG,mutSpecAllMean$temperature, method = 'spearman')
summary(lm(formula = temperature ~ scale(T_C.N) + scale(A_G.N), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) * scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMean))
mutSpecAllMeanNAomit = mutSpecAllMean[!is.na(mutSpecAllMean$A_T.N),]
mutSpecAllMeanNAomit = mutSpecAllMean[!is.na(mutSpecAllMean$TCdivAG),]
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMeanNAomit))
summary(lm(formula = temperature ~ scale(TCdivAG), data = mutSpecAllMeanNAomit))
summary(lm(formula = temperature ~ scale(T_C.N) + scale(A_G.N), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) * scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature), data = mutSpecAllMean))
mutSpecAllMeanNAomit = mutSpecAllMean[!is.na(mutSpecAllMean$TCdivAG),]
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMeanNAomit))
View(mutSpecAllMeanNAomit)
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMeanNAomit))
mutSpecAllMeanNAomit$TCdivAG
table(mutSpecAllMeanNAomit$TCdivAG)
summary((mutSpecAllMeanNAomit$TCdivAG)
summary(mutSpecAllMeanNAomit$TCdivAG)
is.na(mutSpecAllMeanNAomit$TCdivAG)
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
##########Reading MutSpec DataBase with temp and mt of Actinopterigii
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
table(mutSpec$Class)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.N=mean(A_C.N), A_G.N=mean(A_G.N), A_T.N=mean(A_T.N), C_A.N=mean(C_A.N), C_G.N=mean(C_G.N), C_T.N=mean(C_T.N), G_A.N=mean(G_A.N), G_C.N=mean(G_C.N), G_T.N=mean(G_T.N), T_A.N=mean(T_A.N), T_C.N=mean(T_C.N), T_G.N=mean(T_G.N))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/mutSpecAllMean$A_G.N
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf" | mutSpecAllMean$TCdivAG == "NaN",]$TCdivAG = NA
cor.test(mutSpecAllMean$TCdivAG,mutSpecAllMean$temperature, method = 'spearman')
summary(lm(formula = temperature ~ scale(T_C.N) + scale(A_G.N), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) * scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature), data = mutSpecAllMean))
mutSpecAllMeanNAomit = mutSpecAllMean[!is.na(mutSpecAllMean$TCdivAG),]
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMeanNAomit))
log2(TCdivAG)
log2(mutSpecAllMeanNAomit$TCdivAG)
mutSpecAllMeanNAzeroomit = mutSpecAllMean[mutSpecAllMean$TCdivAG != 0,]
mutSpecAllMeanNAzeroomit = mutSpecAllMean[!is.na(mutSpecAllMean$TCdivAG),]
mutSpecAllMeanNAzeroomit = mutSpecAllMean[mutSpecAllMean$TCdivAG != 0,]
log2(mutSpecAllMeanNAomit$TCdivAG)
mutSpecAllMeanNAzeroomit = mutSpecAllMean[!is.na(mutSpecAllMean$TCdivAG),]
mutSpecAllMeanNAzeroomit = mutSpecAllMeanNAzeroomit[mutSpecAllMeanNAzeroomit$TCdivAG != 0,]
log2(mutSpecAllMeanNAomit$TCdivAG)
mutSpecAllMeanNAzeroomit[mutSpecAllMeanNAzeroomit$TCdivAG != 0,]
View(mutSpecAllMeanNAzeroomit)
summary(mutSpecAllMeanNAomit$TCdivAG)
log2(mutSpecAllMeanNAzeroomit$TCdivAG)
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMeanNAzeroomit))
summary(lm(formula = temperature ~ scale(TCdivAG), data = mutSpecAllMeanNAzeroomit))
summary(lm(formula = temperature ~ scale(T_C.N) + scale(A_G.N), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) * scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = T_C.N ~ scale(temperature), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature) + scale(matur_tm), data = mutSpecAllMean))
summary(lm(formula = A_G.N ~ scale(temperature), data = mutSpecAllMean))
mutSpecAllMeanNAzeroomit = mutSpecAllMean[!is.na(mutSpecAllMean$TCdivAG),]
mutSpecAllMeanNAzeroomit = mutSpecAllMeanNAzeroomit[mutSpecAllMeanNAzeroomit$TCdivAG != 0,]
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMeanNAzeroomit))
summary(lm(formula = temperature ~ scale(TCdivAG), data = mutSpecAllMeanNAzeroomit))
########################################################################################################
### PICs ###############################################################################################
########################################################################################################
tree = read.tree('../Data/1raw/mtalign.aln.treefile.rooted')
row.names(mutSpecAllMeanNAzeroomit) = mutSpecAllMeanNAzeroomit$Species
View(mutSpecAllMeanNAzeroomit)
tree_pruned = treedata(tree, mutSpecAllMeanNAzeroomit, sort=T, warnings=T)$phy
########################################################################################################
### PICs ###############################################################################################
########################################################################################################
tree = read.tree('../Data/1raw/mtalign.aln.treefile.rooted')
rm(list=ls(all=TRUE))
if (!require(caper)) install.packages("caper")
if (!require(geiger)) install.packages("geiger")
if (!require(ggpubr)) install.packages("ggpubr")
if (!require(dplyr)) install.packages("dplyr")
library(caper)
library(geiger)
library(ggpubr)
library(dplyr)
##########Reading MutSpec DataBase with temp and mt of Actinopterigii
mutSpec = read.table('../Data/3results/VertebratePolymorphisms.MutSpecData.txt', header = TRUE)
table(mutSpec$Class)
mutSpecCytB = mutSpec[mutSpec$Gene == "CytB",]
mutSpecAllMean = mutSpec %>% group_by(Species, Class, temperature, matur_tm); mutSpecAllMean = mutSpecAllMean %>% summarise(A_C.N=mean(A_C.N), A_G.N=mean(A_G.N), A_T.N=mean(A_T.N), C_A.N=mean(C_A.N), C_G.N=mean(C_G.N), C_T.N=mean(C_T.N), G_A.N=mean(G_A.N), G_C.N=mean(G_C.N), G_T.N=mean(G_T.N), T_A.N=mean(T_A.N), T_C.N=mean(T_C.N), T_G.N=mean(T_G.N))
table(mutSpecAllMean[!is.na(mutSpecAllMean$temperature),]$Class)
#only CytB
######### TC / AG rank corr and log2 models
mutSpecAllMean$TCdivAG=mutSpecAllMean$T_C.N/mutSpecAllMean$A_G.N
mutSpecAllMean[mutSpecAllMean$TCdivAG == "Inf" | mutSpecAllMean$TCdivAG == "NaN",]$TCdivAG = NA
cor.test(mutSpecAllMean$TCdivAG,mutSpecAllMean$temperature, method = 'spearman')
mutSpecAllMeanNAzeroomit = mutSpecAllMean[!is.na(mutSpecAllMean$TCdivAG),]
mutSpecAllMeanNAzeroomit = mutSpecAllMeanNAzeroomit[mutSpecAllMeanNAzeroomit$TCdivAG != 0,]
summary(lm(formula = log2(TCdivAG) ~ scale(temperature), data = mutSpecAllMeanNAzeroomit))
summary(lm(formula = temperature ~ scale(TCdivAG), data = mutSpecAllMeanNAzeroomit))
########################################################################################################
### PICs ###############################################################################################
########################################################################################################
tree = read.tree('../Data/1raw/mtalign.aln.treefile.rooted')
########################################################################################################
### PICs ###############################################################################################
########################################################################################################
tree = read.tree('../Data/1raw/mtalign.aln.treefile.rooted')
########################################################################################################
### PICs ###############################################################################################
########################################################################################################
set_wd('../Data/1raw')
########################################################################################################
### PICs ###############################################################################################
########################################################################################################
setwd('../Data/1raw')
tree = read.tree('../Data/1raw/mtalign.aln.treefile.rooted')
tree = read.tree('mtalign.aln.treefile.rooted')
########################################################################################################
### PICs ###############################################################################################
########################################################################################################
tree = read.tree('../Data/1raw/mtalign.aln.treefile.rooted')
